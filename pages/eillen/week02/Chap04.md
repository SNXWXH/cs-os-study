# `CPU`의 작동 원리

## 01. `ALU`와 제어장치

- `ALU`와 제어장치가 내보내고 받아들이는 정보가 무엇인가 ?

### `ALU` : 계산하는 장치

- 레지스터로부터 피연산자를 받아들이고, 제어장치로부터 제어 신호를 받아들인다.

> - 메모리가 아닌, 레지스터에 저장하는 이유는?<br/> > `CPU`가 레지스터에 접근하는 속도가 `CPU`가 메모리에 접근하는 속도보다 빠르기 때문이다.

- 계산 결과값 외에 `ALU`가 내보내는 또 다른 정보 👉🏻 **플래그**

#### 플래그

- 음수와 양수를 구분하기위해 사용된다.
- '방금 계산한 결과는 음수', '결괏값이 너무 크다'라는 연산 결과의 추가적인 상태 정보를 내보내는 것

> 💡 연산 결과가 연산 결과를 담을 레지스터보다 큰 상황을 \*\*오버플로우(`overflow`)라고 한다.

![chap04-01](../public/chap04/01_chapter.png)

- 플래그는 `CPU`가 프로그램을 실행하는 도중 반드시 기억해야 하는 일종의 참고 정보이다.
- 플래그들은 **플래그 레지스터**라는 레지스터에 저장된다. (플래그를 저장하는 값을 저장하는 레지스터)

### 제어장치 : 제어 신호를 발생시키고 명령어를 해석하는 장치

- 제어신호 : 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기신호

![chap04-02](../public/chap04/02_chapter.png)

1. 제어장치는 **클럭** 신호를 받아들인다.

   - 클럭(`clock`) : 컴퓨터의 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위.
   - 주기에 맞춰 한 레지스터에서 다른 레지스터로 이동, `ALU`에서 연산 수행, `CPU`가 메모리에 저장된 명령어를 읽어들이는 것들.
   - But, 컴퓨터의 모든 부품이 클럭신호에 맞춰 작동하는 것을 모든 부품이 한 클럭마다 이동한다는 것이 아니라 **하나의 명령어가 여러 클럭에 걸쳐 실행**될 수 있다.

2. 제어장치는 **현재 해석해야 할 명령어**를 받아들인다.

   - `CPU`가 해석해야 할 명령어는 **명령어 레지스터**라는 특별한 레지스터에 저장된다.
   - 레지스터로부터 해석할 명령어를 받아들이고 해석한 뒤, 제어신호를 발생시켜 컴퓨터 부품들에 수행할 내용을 알려준다.

3. 제어장치는 플래그 레지스터 속 **플래그 값**을 받아들인다.

   - 제어장치는 플래그 값을 받아들이고 이를 참고해 제어 신호를 발생한다.

4. 제어장치는 시스템 버스, 그 중에서 제어 버스로 전달된 **제어 신호**를 받아들인다.
   - `CPU` 내부와 외부로 제어신호를 보낸다.
     - 크게 메모리에 전달하는 제어신호
     - 입출력장치(보조기억장치 포함)에 전달하는 제어신호

## 02. 레지스터

- 레지스터 속 값을 유심히 관찰하면 프로그램을 실행할 때 `CPU` 내에서 무슨일이 벌어지는지, 어떤 명령어가 어떻게 수행되는지 알 수 있다.
- `CPU`안에 다양한 레지스터들의 어떤 역할을 할까 ?

### 반드시 알아야 할 레지스터

#### 프로그램 카운터 (`PC : Program Counter`)

- 메모리를 가져올 명령어의 주소 즉, **메모리에서 일어 들일 명령어 주소를 저장**한다.
- 명령어 포인터(`IP : Instruction Pointer`)라고 부르는 `CPU`도 있다.

#### 명령어 레지스터 (`IR : Instruction Register`)

- 해석할 명령어, 즉 방금 메모리에서 읽어 들인 명령어를 저장하는 레지스터

#### 메모리 주소 레지스터 (`MAR : Memory Address Register`)

- 메모리의 주소를 저장하는 레지스터
- `CPU`가 읽어 들이고자 하는 주소 값을 주소 버스로 보낼 때 메모리 주소 레지스터를 거친다.

#### 메모리 버퍼 레지스터 (`MBR : Memory Buffer Register`)

- 메모리와 주고받을 값(데이터와 명령어)을 저장하는 레지스터
- 메모리 데이터 레지스터(`MDR : Memory Data Register`)라고도 부른다.

#### 플래그 레지스터

- 연산 결과 또는 `CPU` 상태에 대한 부가적인 정보를 저장하는 레지스터

#### 범용 레지스터

- 이름 그대로 다양하고 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터

#### 스택 레지스터

- 스택과 스택 포인터를 이용한 스택 주소 지정 방식
- 스택 포인터 : 스택의 꼭대기를 가리키는 레지스터 (스택이 어디까지 차 있는지에 대한 표시)

#### 베이스 레지스터

- 오퍼랜드 필드의 값(변위)과 특정 레지스터의 값을 더하여 유효 주소 얻는 방식

### 특정 레지스터를 이용한 주소 지정 방식(1) : 스택 주소 지정 방식

### 특정 레지스터를 이용한 주소 지정 방식(2) : 변위 주소 지정 방식

## 03. 명령어 사이클과 인터럽트

### 명령어 사이클

### 인터럽트
